<% if current_user == @venue_user %>
  <% recipient = @user.first_name %>
<% else %>
  <% recipient = @venue_user.first_name %>
<% end %>
<div class="chatroom">
  <h1><strong><%= "Chatting with #{recipient}" %></strong></h1>

  <div id="messages" data-chatroom-id="<%= @chatroom.id %>">
    <% @chatroom.messages.each do |message| %>
      <% if message.user == current_user %>
        <div class="message-container text-right" id="message-<%= message.id %>">
          <i class="author">
            <span><%= message.user.first_name %></span>
            <small><%= message.created_at.strftime("%a %b %e at %l:%M%p") %></small>
          </i>
          <p><%= message.content %></p>
        </div>
      <% else %>
        <div class="message-container" id="message-<%= message.id %>">
          <i class="author">
            <span><%= message.user.first_name %></span>
            <small><%= message.created_at.strftime("%a %b %e at %l:%M%p") %></small>
          </i>
          <p><%= message.content %></p>
        </div>
      <% end %>
    <% end %>
  </div>

  <%= simple_form_for [ @venue, @booking, @booking.chatroom, @message ], remote: true do |f| %>
    <%= f.input :content, label: false, placeholder: "Message #{recipient}" %>
    <%= button_tag type: 'submit', class: "my-button", id: "button" do %>
      <i class="fas fa-paper-plane" aria-hidden="true"></i>
    <% end %>
  <% end %>
</div>

